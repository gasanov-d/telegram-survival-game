<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Last Island Survival (Demo)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Telegram WebApp -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    body {
      margin: 0;
      background: #0f1115;
      color: #fff;
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    #game {
      width: 90%;
      max-width: 420px;
      text-align: center;
    }

    .card {
      background: #1c1f26;
      padding: 12px;
      border-radius: 10px;
      margin-bottom: 10px;
    }

    button {
      width: 100%;
      padding: 14px;
      margin: 6px 0;
      font-size: 16px;
      border: none;
      border-radius: 10px;
      background: #2a9df4;
      color: #fff;
    }

    button:active {
      opacity: 0.8;
    }

    .log {
      margin-top: 10px;
      min-height: 24px;
      color: #9ad1ff;
    }
  </style>
</head>
<body>

<div id="game"></div>

<script>
  // === TELEGRAM INIT ===
  const tg = window.Telegram.WebApp;
  tg.ready();
  tg.expand();

  // === GAME STATE ===
  let location = "base";

  let stats = {
    hp: 100,
    hunger: 100,
    energy: 100
  };

  let resources = {
    wood: 0
  };

  let buildings = {
    fire: false,
    workbench: false
  };

  // === RENDER ===
  function render() {
    const game = document.getElementById("game");

    if (location === "base") {
      game.innerHTML = `
        <h2>üè† –¢–≤–æ—è –±–∞–∑–∞</h2>

        <div class="card">
          ‚ù§Ô∏è HP: ${stats.hp}<br>
          üçñ –ì–æ–ª–æ–¥: ${stats.hunger}<br>
          ‚ö° –≠–Ω–µ—Ä–≥–∏—è: ${stats.energy}
        </div>

        <div class="card">
          ü™µ –î–µ—Ä–µ–≤–æ: ${resources.wood}
        </div>

        <div class="card">
          üî• –ö–æ—Å—Ç—ë—Ä: <b>${buildings.fire ? "–ø–æ—Å—Ç—Ä–æ–µ–Ω" : "–Ω–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω"}</b><br>
          üõ† –í–µ—Ä—Å—Ç–∞–∫: <b>${buildings.workbench ? "–ø–æ—Å—Ç—Ä–æ–µ–Ω" : "–Ω–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω"}</b>
        </div>

        <button onclick="goForest()">üå≤ –í—ã–π—Ç–∏ –≤ –ª–µ—Å</button>

        <button onclick="buildFire()">üî• –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∫–æ—Å—Ç—ë—Ä (5 –¥–µ—Ä–µ–≤–∞)</button>

        <div class="log" id="log"></div>
      `;
    }

    if (location === "forest") {
      game.innerHTML = `
        <h2>üå≤ –õ–µ—Å</h2>

        <div class="card">
          –¢—ã –≤ –ª–µ—Å—É. –ú–æ–∂–Ω–æ –¥–æ–±—ã–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã.
        </div>

        <button onclick="chopWood()">ü™ì –†—É–±–∏—Ç—å –¥–µ—Ä–µ–≤–æ</button>
        <button onclick="returnBase()">üè† –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –±–∞–∑—É</button>

        <div class="log" id="log"></div>
      `;
    }
  }

  // === ACTIONS ===
  function goForest() {
    location = "forest";
    render();
  }

  function returnBase() {
    location = "base";
    render();
  }

  function chopWood() {
    const gain = Math.floor(Math.random() * 3) + 1;
    resources.wood += gain;
    stats.energy -= 5;
    stats.hunger -= 3;

    document.getElementById("log").textContent =
      `–¢—ã –¥–æ–±—ã–ª ${gain} –¥–µ—Ä–µ–≤–∞`;

    checkStats();
  }

  function buildFire() {
    if (buildings.fire) {
      log("–ö–æ—Å—Ç—ë—Ä —É–∂–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω");
      return;
    }

    if (resources.wood < 5) {
      log("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ—Ä–µ–≤–∞");
      return;
    }

    resources.wood -= 5;
    buildings.fire = true;
    log("–¢—ã –ø–æ—Å—Ç—Ä–æ–∏–ª –∫–æ—Å—Ç—ë—Ä üî•");
    render();
  }

  function checkStats() {
    if (stats.energy < 0) stats.energy = 0;
    if (stats.hunger < 0) stats.hunger = 0;

    if (stats.energy === 0 || stats.hunger === 0) {
      stats.hp -= 10;
    }

    if (stats.hp <= 0) {
      document.getElementById("game").innerHTML = `
        <h2>‚ò†Ô∏è –¢—ã —É–º–µ—Ä</h2>
        <p>–í—ã–∂–∏–≤–∞–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å</p>
      `;
      return;
    }

    render();
  }

  function log(text) {
    const el = document.getElementById("log");
    if (el) el.textContent = text;
  }

  // === START ===
  render();
</script>

</body>
</html>
