<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Survival</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: #000;
  overflow: hidden;
}

canvas {
  display: block;
  background: #2e7d32;
}
</style>
</head>
<body>

<canvas id="game"></canvas>

<script>
/* === TELEGRAM === */
const tg = window.Telegram.WebApp;
tg.ready();
tg.expand();

/* === CANVAS === */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

/* === PLAYER === */
const player = {
  x: 200,
  y: 200,
  size: 32,
  speed: 3
};

/* === MAP OBJECTS === */
const trees = [];
for (let i = 0; i < 20; i++) {
  trees.push({
    x: Math.random() * 2000,
    y: Math.random() * 2000,
    size: 40
  });
}

/* === CAMERA === */
let camX = 0;
let camY = 0;

/* === INPUT === */
const keys = {};
document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

/* === GAME LOOP === */
function update() {
  if (keys["w"]) player.y -= player.speed;
  if (keys["s"]) player.y += player.speed;
  if (keys["a"]) player.x -= player.speed;
  if (keys["d"]) player.x += player.speed;

  camX = player.x - canvas.width / 2;
  camY = player.y - canvas.height / 2;
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // ground
  ctx.fillStyle = "#2e7d32";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // trees
  ctx.fillStyle = "#1b5e20";
  trees.forEach(t => {
    ctx.fillRect(
      t.x - camX,
      t.y - camY,
      t.size,
      t.size
    );
  });

  // player
  ctx.fillStyle = "#ffca28";
  ctx.fillRect(
    player.x - camX,
    player.y - camY,
    player.size,
    player.size
  );
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
